function Grade(a,b,c,d){this.id=a,this.fullVal=b,this.val=c,this.subject=d}function Subject(a,b,c){this.id=a,this.avg=b,this.numberOfGrades=c}function calculateAndDisplayTheAverage(){let b=0,c=0,d=0,e=1,f=0;for(;isGradeExist(e);)dataOfGrade=getGradeHTMLData(e),grade=getGradeValue(e),isNumberWithPlusOrMinus(grade)&&(hasPlusOrMinus(grade)&&(grade=convertGradeToNumber(grade)),gradeWeight=getGradeWeight(dataOfGrade),b+=grade*gradeWeight,c+=Number(gradeWeight)),e++,isNextGradeOfSubject(e-1)||(f++,subject=subjects[f]=new Subject(f),subject.avg=b/c,setAvgOfSubjectOnPage(f,subject.avg),b=0,c=0,d+=subject.avg);d/=f,console.log("Your avg: "+d),gradesCounter=e-1,setAvgValueOfUserOnPage(d.toFixed(a))}function createContainersOnPage(){$(".container-icon > table > tbody > tr > td").last().after('<td><p><b>Œrednia: </b><span id="studentAvg">!</span><br /><b>Wszystkich ocen: </b><span id="numberOfAllGrades">!</span></p></td>');let a=0,b=0;for(;isGradeExist(a);)a++,isNextGradeOfSubject(a)||(b++,$("#Ocena"+a).parent().next().append('<span id="avgSubject'+b+'"> ! </span>'))}function updateAll(){grades=[],subjects=[],numberOfAllGrades=countGrades(),calculateAndDisplayTheAverage(),setNumberOfGradesOnPage(numberOfAllGrades),console.log("updated")}function setAvgOfSubjectOnPage(b,c){$("#avgSubject"+b).text(c.toFixed(a))}function createUpdateButton(){$(".inside").after('<div id="updateButton"><span class="fold"><a href="#" class="fold-link"><span class="fold-start">Aktualizuj œredni¹</span><span class="fold-end"></span></a></span></div>'),$("#updateButton").click(function(){updateAll()})}function setAvgValueOfUserOnPage(a){$("#studentAvg").text(a)}function setNumberOfGradesOnPage(a){$("#numberOfAllGrades").text(a)}function getGradeHTMLData(a){return $("#Ocena"+a).html()}function getGradeValue(a){return $("#Ocena"+a+"> a").html()}function hasPlusOrMinus(a){return!!(a.search(/\+/g)!=-1|a.search("-")!=-1&&a.length>1)}function isNumberWithPlusOrMinus(a){return hasPlusOrMinus(a)&&(a=a.replace(/\+/g,""),a=a.replace("-","")),!isNaN(a)}function isGradeExist(a){return null!=$("#Ocena"+a).html()}function isNextGradeOfSubject(a){return"undefined"!=typeof $("#Ocena"+a).next().html()}function convertGradeToNumber(a){return a.search(/\+/g)!=-1?(a=Number(a.replace(/\+/g,"")),a+=.5):a.search("-")!=-1&&(a=Number(a.replace("-","")),a-=.25),a}function getGradeWeight(a){let b=0;return a.indexOf("Waga:")!==-1&&(b=a.substring(a.indexOf("Waga:")+6,a.indexOf("Waga:")+8),0!=b.substring(1,2)&&(b=b.substring(0,1))),b}function countGrades(a){let b=0,c=0;for(;isGradeExist(c);)b++,c++;return b}grades=[],subjects=[],numberOfAllGrades=countGrades();const a=2;window.onload=function(){createContainersOnPage(),calculateAndDisplayTheAverage(),setNumberOfGradesOnPage(numberOfAllGrades),createUpdateButton()};